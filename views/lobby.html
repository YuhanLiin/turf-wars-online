<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>Lobby</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
</head>

<body>
    <div id="rooms"></div>

    <script>
        function add2Rooms(room){
            $('#rooms').append(`<div id="${room.id}">${room.id} hosted by ${room.host}</div>`);
        }

        var rooms = {{rooms}};
        for (let i=0; i<rooms.length; i++){
            let room = rooms[i];
            add2Rooms(room);
        }

        var socket = io('/lobby');
        socket.on('add', function(roomJson){
            add2Rooms(JSON.parse(roomJson));
        })
        .on('delete', function(roomId){
            $('#rooms').remove('#'+roomId);
        })
    </script>
</body>
</html>